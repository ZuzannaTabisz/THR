/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home/inf151561/sol3/train.py:158: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=True)
/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/amp/grad_scaler.py:132: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
Training:   0%|          | 0/154 [00:00<?, ?it/s]/home/inf151561/sol3/train.py:67: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=True):
/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/amp/autocast_mode.py:266: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
                                                 Traceback (most recent call last):
  File "/home/inf151561/sol3/train.py", line 185, in <module>
    run_training(args)
  File "/home/inf151561/sol3/train.py", line 165, in run_training
    train_loss = train_one_epoch(model, optimizer, scheduler, criterion, train_loader, device, scaler)
  File "/home/inf151561/sol3/train.py", line 68, in train_one_epoch
    y_preds = model(images)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/inf151561/sol3/model.py", line 122, in forward
    x = self.norm(x)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 217, in forward
    return F.layer_norm(
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/nn/functional.py", line 2900, in layer_norm
    return torch.layer_norm(
RuntimeError: Given normalized_shape=[1536], expected input with shape [*, 1536], but got input of size[4, 16, 18432]
