Training:   0%|          | 0/154 [00:00<?, ?it/s]Training:   1%|          | 1/154 [00:04<10:29,  4.11s/it]Training:   1%|▏         | 2/154 [00:06<07:25,  2.93s/it]Training:   2%|▏         | 3/154 [00:08<06:17,  2.50s/it]Training:   3%|▎         | 4/154 [00:10<05:42,  2.28s/it]Training:   3%|▎         | 5/154 [00:12<05:22,  2.16s/it]Training:   4%|▍         | 6/154 [00:14<05:11,  2.11s/it]Training:   5%|▍         | 7/154 [00:16<05:00,  2.04s/it]Training:   5%|▌         | 8/154 [00:18<04:59,  2.05s/it]Training:   6%|▌         | 9/154 [00:20<04:52,  2.02s/it]Training:   6%|▋         | 10/154 [00:22<04:48,  2.00s/it]Training:   7%|▋         | 11/154 [00:23<04:44,  1.99s/it]Training:   8%|▊         | 12/154 [00:25<04:44,  2.00s/it]Training:   8%|▊         | 13/154 [00:27<04:36,  1.96s/it]Training:   9%|▉         | 14/154 [00:29<04:32,  1.95s/it]Training:  10%|▉         | 15/154 [00:31<04:31,  1.96s/it]Training:  10%|█         | 16/154 [00:33<04:32,  1.98s/it]Training:  11%|█         | 17/154 [00:35<04:30,  1.97s/it]Training:  12%|█▏        | 18/154 [00:37<04:27,  1.97s/it]Training:  12%|█▏        | 19/154 [00:39<04:22,  1.95s/it]Training:  13%|█▎        | 20/154 [00:41<04:19,  1.94s/it]Training:  14%|█▎        | 21/154 [00:43<04:19,  1.95s/it]Training:  14%|█▍        | 22/154 [00:45<04:17,  1.95s/it]Training:  15%|█▍        | 23/154 [00:47<04:17,  1.97s/it]Training:  16%|█▌        | 24/154 [00:49<04:09,  1.92s/it]Training:  16%|█▌        | 25/154 [00:51<04:08,  1.92s/it]Training:  17%|█▋        | 26/154 [00:53<04:09,  1.95s/it]Training:  18%|█▊        | 27/154 [00:55<04:09,  1.96s/it]Training:  18%|█▊        | 28/154 [00:57<04:08,  1.97s/it]Training:  19%|█▉        | 29/154 [00:58<03:59,  1.92s/it]Training:  19%|█▉        | 30/154 [01:00<03:57,  1.91s/it]Training:  20%|██        | 31/154 [01:02<03:54,  1.91s/it]Training:  21%|██        | 32/154 [01:04<03:56,  1.94s/it]Training:  21%|██▏       | 33/154 [01:06<03:52,  1.93s/it]Training:  22%|██▏       | 34/154 [01:08<03:46,  1.89s/it]Training:  23%|██▎       | 35/154 [01:10<03:46,  1.90s/it]Training:  23%|██▎       | 36/154 [01:12<03:51,  1.97s/it]Training:  24%|██▍       | 37/154 [01:14<03:52,  1.98s/it]Training:  25%|██▍       | 38/154 [01:16<03:46,  1.95s/it]Training:  25%|██▌       | 39/154 [01:18<03:46,  1.97s/it]Training:  26%|██▌       | 40/154 [01:20<03:45,  1.98s/it]Training:  27%|██▋       | 41/154 [01:22<03:42,  1.97s/it]Training:  27%|██▋       | 42/154 [01:24<03:38,  1.95s/it]Training:  28%|██▊       | 43/154 [01:26<03:33,  1.93s/it]Training:  29%|██▊       | 44/154 [01:28<03:33,  1.94s/it]Training:  29%|██▉       | 45/154 [01:30<03:29,  1.92s/it]Training:  30%|██▉       | 46/154 [01:31<03:27,  1.92s/it]Training:  31%|███       | 47/154 [01:33<03:28,  1.95s/it]Training:  31%|███       | 48/154 [01:35<03:21,  1.90s/it]Training:  32%|███▏      | 49/154 [01:37<03:19,  1.90s/it]Training:  32%|███▏      | 50/154 [01:39<03:17,  1.90s/it]Training:  33%|███▎      | 51/154 [01:41<03:15,  1.90s/it]Training:  34%|███▍      | 52/154 [01:43<03:14,  1.90s/it]Training:  34%|███▍      | 53/154 [01:45<03:17,  1.95s/it]Training:  35%|███▌      | 54/154 [01:47<03:15,  1.95s/it]Training:  36%|███▌      | 55/154 [01:49<03:15,  1.98s/it]Training:  36%|███▋      | 56/154 [01:51<03:09,  1.94s/it]Training:  37%|███▋      | 57/154 [01:53<03:09,  1.95s/it]Training:  38%|███▊      | 58/154 [01:55<03:05,  1.93s/it]Training:  38%|███▊      | 59/154 [01:57<03:02,  1.92s/it]Training:  39%|███▉      | 60/154 [01:58<03:01,  1.93s/it]Training:  40%|███▉      | 61/154 [02:00<02:57,  1.91s/it]Training:  40%|████      | 62/154 [02:02<02:56,  1.92s/it]Training:  41%|████      | 63/154 [02:04<02:55,  1.93s/it]Training:  42%|████▏     | 64/154 [02:06<02:56,  1.96s/it]Training:  42%|████▏     | 65/154 [02:08<02:56,  1.98s/it]Training:  43%|████▎     | 66/154 [02:10<02:54,  1.98s/it]Training:  44%|████▎     | 67/154 [02:12<02:50,  1.96s/it]Training:  44%|████▍     | 68/154 [02:14<02:47,  1.95s/it]Training:  45%|████▍     | 69/154 [02:16<02:46,  1.96s/it]Training:  45%|████▌     | 70/154 [02:18<02:44,  1.96s/it]Training:  46%|████▌     | 71/154 [02:20<02:43,  1.97s/it]Training:  47%|████▋     | 72/154 [02:22<02:42,  1.98s/it]Training:  47%|████▋     | 73/154 [02:24<02:40,  1.98s/it]Training:  48%|████▊     | 74/154 [02:26<02:38,  1.98s/it]Training:  49%|████▊     | 75/154 [02:28<02:34,  1.96s/it]Training:  49%|████▉     | 76/154 [02:30<02:33,  1.97s/it]Training:  50%|█████     | 77/154 [02:32<02:31,  1.96s/it]Training:  51%|█████     | 78/154 [02:34<02:25,  1.92s/it]Training:  51%|█████▏    | 79/154 [02:36<02:25,  1.94s/it]Training:  52%|█████▏    | 80/154 [02:38<02:23,  1.94s/it]Training:  53%|█████▎    | 81/154 [02:40<02:22,  1.95s/it]Training:  53%|█████▎    | 82/154 [02:42<02:22,  1.98s/it]Training:  54%|█████▍    | 83/154 [02:44<02:19,  1.97s/it]Training:  55%|█████▍    | 84/154 [02:46<02:18,  1.98s/it]Training:  55%|█████▌    | 85/154 [02:48<02:16,  1.99s/it]Training:  56%|█████▌    | 86/154 [02:50<02:15,  2.00s/it]Training:  56%|█████▋    | 87/154 [02:52<02:14,  2.01s/it]Training:  57%|█████▋    | 88/154 [02:54<02:11,  2.00s/it]Training:  58%|█████▊    | 89/154 [02:56<02:09,  1.99s/it]Training:  58%|█████▊    | 90/154 [02:57<02:05,  1.96s/it]Training:  59%|█████▉    | 91/154 [02:59<02:02,  1.94s/it]Training:  60%|█████▉    | 92/154 [03:01<01:59,  1.93s/it]Training:  60%|██████    | 93/154 [03:03<01:58,  1.94s/it]Training:  61%|██████    | 94/154 [03:05<01:57,  1.96s/it]Training:  62%|██████▏   | 95/154 [03:07<01:56,  1.98s/it]Training:  62%|██████▏   | 96/154 [03:09<01:55,  1.98s/it]Training:  63%|██████▎   | 97/154 [03:11<01:53,  1.99s/it]Training:  64%|██████▎   | 98/154 [03:13<01:47,  1.92s/it]Training:  64%|██████▍   | 99/154 [03:15<01:47,  1.95s/it]Training:  65%|██████▍   | 100/154 [03:17<01:44,  1.94s/it]Training:  66%|██████▌   | 101/154 [03:19<01:43,  1.95s/it]Training:  66%|██████▌   | 102/154 [03:21<01:41,  1.95s/it]Training:  67%|██████▋   | 103/154 [03:23<01:38,  1.92s/it]Training:  68%|██████▊   | 104/154 [03:25<01:37,  1.95s/it]Training:  68%|██████▊   | 105/154 [03:27<01:36,  1.98s/it]Training:  69%|██████▉   | 106/154 [03:29<01:34,  1.97s/it]Training:  69%|██████▉   | 107/154 [03:31<01:33,  1.99s/it]Training:  70%|███████   | 108/154 [03:33<01:31,  1.98s/it]Training:  71%|███████   | 109/154 [03:35<01:28,  1.96s/it]Training:  71%|███████▏  | 110/154 [03:37<01:25,  1.95s/it]Training:  72%|███████▏  | 111/154 [03:39<01:24,  1.96s/it]Training:  73%|███████▎  | 112/154 [03:40<01:21,  1.95s/it]Training:  73%|███████▎  | 113/154 [03:42<01:19,  1.93s/it]Training:  74%|███████▍  | 114/154 [03:44<01:17,  1.94s/it]Training:  75%|███████▍  | 115/154 [03:46<01:14,  1.92s/it]Training:  75%|███████▌  | 116/154 [03:48<01:12,  1.92s/it]Training:  76%|███████▌  | 117/154 [03:50<01:11,  1.93s/it]Training:  77%|███████▋  | 118/154 [03:52<01:10,  1.96s/it]Training:  77%|███████▋  | 119/154 [03:54<01:09,  1.97s/it]Training:  78%|███████▊  | 120/154 [03:56<01:08,  2.00s/it]Training:  79%|███████▊  | 121/154 [03:58<01:05,  1.98s/it]Training:  79%|███████▉  | 122/154 [04:00<01:02,  1.95s/it]Training:  80%|███████▉  | 123/154 [04:02<01:00,  1.96s/it]Training:  81%|████████  | 124/154 [04:04<00:58,  1.95s/it]Training:  81%|████████  | 125/154 [04:06<00:55,  1.90s/it]Training:  82%|████████▏ | 126/154 [04:08<00:54,  1.94s/it]Training:  82%|████████▏ | 127/154 [04:10<00:52,  1.94s/it]Training:  83%|████████▎ | 128/154 [04:12<00:50,  1.93s/it]Training:  84%|████████▍ | 129/154 [04:14<00:48,  1.93s/it]Training:  84%|████████▍ | 130/154 [04:15<00:46,  1.93s/it]Training:  85%|████████▌ | 131/154 [04:17<00:44,  1.95s/it]Training:  86%|████████▌ | 132/154 [04:19<00:43,  1.96s/it]Training:  86%|████████▋ | 133/154 [04:21<00:41,  1.96s/it]Training:  87%|████████▋ | 134/154 [04:23<00:39,  1.99s/it]Training:  88%|████████▊ | 135/154 [04:25<00:38,  2.01s/it]Training:  88%|████████▊ | 136/154 [04:28<00:36,  2.01s/it]Training:  89%|████████▉ | 137/154 [04:30<00:34,  2.01s/it]Training:  90%|████████▉ | 138/154 [04:32<00:32,  2.02s/it]Training:  90%|█████████ | 139/154 [04:34<00:30,  2.04s/it]Training:  91%|█████████ | 140/154 [04:36<00:28,  2.02s/it]Training:  92%|█████████▏| 141/154 [04:38<00:26,  2.01s/it]Training:  92%|█████████▏| 142/154 [04:39<00:23,  1.97s/it]Training:  93%|█████████▎| 143/154 [04:41<00:21,  1.98s/it]Training:  94%|█████████▎| 144/154 [04:43<00:19,  1.97s/it]Training:  94%|█████████▍| 145/154 [04:45<00:17,  1.96s/it]Training:  95%|█████████▍| 146/154 [04:47<00:15,  1.94s/it]Training:  95%|█████████▌| 147/154 [04:49<00:13,  1.96s/it]Training:  96%|█████████▌| 148/154 [04:51<00:11,  1.96s/it]Training:  97%|█████████▋| 149/154 [04:53<00:09,  1.93s/it]Training:  97%|█████████▋| 150/154 [04:55<00:07,  1.95s/it]Training:  98%|█████████▊| 151/154 [04:57<00:05,  1.97s/it]Training:  99%|█████████▊| 152/154 [04:59<00:03,  1.95s/it]Training:  99%|█████████▉| 153/154 [05:01<00:01,  1.97s/it]Training: 100%|██████████| 154/154 [05:02<00:00,  1.56s/it]                                                           Validating:   0%|          | 0/36 [00:00<?, ?it/s]Validating:   3%|▎         | 1/36 [00:01<00:54,  1.57s/it]Validating:   6%|▌         | 2/36 [00:03<00:52,  1.54s/it]Validating:   8%|▊         | 3/36 [00:04<00:51,  1.57s/it]Validating:  11%|█         | 4/36 [00:06<00:51,  1.60s/it]Validating:  14%|█▍        | 5/36 [00:07<00:46,  1.50s/it]Validating:  17%|█▋        | 6/36 [00:09<00:45,  1.51s/it]Validating:  19%|█▉        | 7/36 [00:10<00:44,  1.53s/it]Validating:  22%|██▏       | 8/36 [00:12<00:41,  1.49s/it]Validating:  25%|██▌       | 9/36 [00:13<00:40,  1.49s/it]Validating:  28%|██▊       | 10/36 [00:15<00:38,  1.49s/it]Validating:  31%|███       | 11/36 [00:16<00:37,  1.51s/it]Validating:  33%|███▎      | 12/36 [00:18<00:35,  1.49s/it]Validating:  36%|███▌      | 13/36 [00:19<00:34,  1.50s/it]Validating:  39%|███▉      | 14/36 [00:21<00:33,  1.51s/it]Validating:  42%|████▏     | 15/36 [00:22<00:32,  1.53s/it]Validating:  44%|████▍     | 16/36 [00:24<00:31,  1.56s/it]Validating:  47%|████▋     | 17/36 [00:26<00:29,  1.56s/it]Validating:  50%|█████     | 18/36 [00:27<00:27,  1.55s/it]Validating:  53%|█████▎    | 19/36 [00:28<00:25,  1.48s/it]Validating:  56%|█████▌    | 20/36 [00:30<00:23,  1.47s/it]Validating:  58%|█████▊    | 21/36 [00:31<00:22,  1.48s/it]Validating:  61%|██████    | 22/36 [00:33<00:20,  1.46s/it]Validating:  64%|██████▍   | 23/36 [00:34<00:19,  1.47s/it]Validating:  67%|██████▋   | 24/36 [00:36<00:17,  1.43s/it]Validating:  69%|██████▉   | 25/36 [00:37<00:16,  1.47s/it]Validating:  72%|███████▏  | 26/36 [00:39<00:14,  1.49s/it]Validating:  75%|███████▌  | 27/36 [00:40<00:13,  1.51s/it]Validating:  78%|███████▊  | 28/36 [00:42<00:11,  1.49s/it]Validating:  81%|████████  | 29/36 [00:43<00:10,  1.48s/it]Validating:  83%|████████▎ | 30/36 [00:45<00:08,  1.48s/it]Validating:  86%|████████▌ | 31/36 [00:46<00:07,  1.48s/it]Validating:  89%|████████▉ | 32/36 [00:47<00:05,  1.46s/it]Validating:  92%|█████████▏| 33/36 [00:49<00:04,  1.49s/it]Validating:  94%|█████████▍| 34/36 [00:51<00:02,  1.49s/it]Validating:  97%|█████████▋| 35/36 [00:52<00:01,  1.51s/it]Validating: 100%|██████████| 36/36 [00:52<00:00,  1.17s/it]                                                           Traceback (most recent call last):
  File "/home/inf151561/sol3/train.py", line 185, in <module>
    run_training(args)
  File "/home/inf151561/sol3/train.py", line 166, in run_training
    val_loss, competition_score = validate_one_epoch(model, criterion, valid_loader, device)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/inf151561/sol3/train.py", line 104, in validate_one_epoch
    competition_loss = log_loss(y_true=all_labels, y_pred=all_preds, labels=[0,1])
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/sklearn/metrics/_classification.py", line 2982, in log_loss
    transformed_labels = lb.transform(y_true)
  File "/home/inf151561/miniconda3/envs/mayo_env/lib/python3.9/site-packages/sklearn/preprocessing/_label.py", line 361, in transform
    raise ValueError("The object was not fitted with multilabel input.")
ValueError: The object was not fitted with multilabel input.
